{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect } from 'react';\nimport Router from 'next/router';\nimport useSWR from 'swr';\n\nvar fetchUser = function fetchUser(url) {\n  return fetch(url).then(function (r) {\n    return r.json();\n  }).then(function (data) {\n    return {\n      user: (data === null || data === void 0 ? void 0 : data.user) || null\n    };\n  });\n};\n\nexport function useUser() {\n  _s();\n\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      redirectTo = _ref.redirectTo,\n      redirectIfFound = _ref.redirectIfFound;\n\n  var _useSWR = useSWR('/api/user', fetchUser),\n      data = _useSWR.data,\n      error = _useSWR.error;\n\n  var user = data === null || data === void 0 ? void 0 : data.user;\n  var finished = Boolean(data);\n  var hasUser = Boolean(user);\n  useEffect(function () {\n    if (!redirectTo || !finished) return;\n\n    if ( // If redirectTo is set, redirect if the user was not found.\n    redirectTo && !redirectIfFound && !hasUser || // If redirectIfFound is also set, redirect if the user was found\n    redirectIfFound && hasUser) {\n      Router.push(redirectTo);\n    }\n  }, [redirectTo, redirectIfFound, finished, hasUser]);\n  return error ? null : user;\n}\n\n_s(useUser, \"i5WvaAFDajHCNU98qq4Vb7coGq0=\", false, function () {\n  return [useSWR];\n});","map":{"version":3,"sources":["D:/identity-managment/lib/hooks.js"],"names":["useEffect","Router","useSWR","fetchUser","url","fetch","then","r","json","data","user","useUser","redirectTo","redirectIfFound","error","finished","Boolean","hasUser","push"],"mappings":";;AAAA,SAASA,SAAT,QAA0B,OAA1B;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,OAAOC,MAAP,MAAmB,KAAnB;;AAEA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,GAAD;AAAA,SAChBC,KAAK,CAACD,GAAD,CAAL,CACGE,IADH,CACQ,UAACC,CAAD;AAAA,WAAOA,CAAC,CAACC,IAAF,EAAP;AAAA,GADR,EAEGF,IAFH,CAEQ,UAACG,IAAD,EAAU;AACd,WAAO;AAAEC,MAAAA,IAAI,EAAE,CAAAD,IAAI,SAAJ,IAAAA,IAAI,WAAJ,YAAAA,IAAI,CAAEC,IAAN,KAAc;AAAtB,KAAP;AACD,GAJH,CADgB;AAAA,CAAlB;;AAOA,OAAO,SAASC,OAAT,GAAuD;AAAA;;AAAA,iFAAJ,EAAI;AAAA,MAApCC,UAAoC,QAApCA,UAAoC;AAAA,MAAxBC,eAAwB,QAAxBA,eAAwB;;AAAA,gBACpCX,MAAM,CAAC,WAAD,EAAcC,SAAd,CAD8B;AAAA,MACpDM,IADoD,WACpDA,IADoD;AAAA,MAC9CK,KAD8C,WAC9CA,KAD8C;;AAE5D,MAAMJ,IAAI,GAAGD,IAAH,aAAGA,IAAH,uBAAGA,IAAI,CAAEC,IAAnB;AACA,MAAMK,QAAQ,GAAGC,OAAO,CAACP,IAAD,CAAxB;AACA,MAAMQ,OAAO,GAAGD,OAAO,CAACN,IAAD,CAAvB;AAEAV,EAAAA,SAAS,CAAC,YAAM;AACd,QAAI,CAACY,UAAD,IAAe,CAACG,QAApB,EAA8B;;AAC9B,SACE;AACCH,IAAAA,UAAU,IAAI,CAACC,eAAf,IAAkC,CAACI,OAApC,IACA;AACCJ,IAAAA,eAAe,IAAII,OAJtB,EAKE;AACAhB,MAAAA,MAAM,CAACiB,IAAP,CAAYN,UAAZ;AACD;AACF,GAVQ,EAUN,CAACA,UAAD,EAAaC,eAAb,EAA8BE,QAA9B,EAAwCE,OAAxC,CAVM,CAAT;AAWA,SAAOH,KAAK,GAAG,IAAH,GAAUJ,IAAtB;AACD;;GAlBeC,O;UACUT,M","sourcesContent":["import { useEffect } from 'react';\r\nimport Router from 'next/router';\r\nimport useSWR from 'swr';\r\n\r\nconst fetchUser = (url) =>\r\n  fetch(url)\r\n    .then((r) => r.json())\r\n    .then((data) => {\r\n      return { user: data?.user || null };\r\n    });\r\n\r\nexport function useUser({ redirectTo, redirectIfFound } = {}) {\r\n  const { data, error } = useSWR('/api/user', fetchUser);\r\n  const user = data?.user;\r\n  const finished = Boolean(data);\r\n  const hasUser = Boolean(user);\r\n\r\n  useEffect(() => {\r\n    if (!redirectTo || !finished) return;\r\n    if (\r\n      // If redirectTo is set, redirect if the user was not found.\r\n      (redirectTo && !redirectIfFound && !hasUser) ||\r\n      // If redirectIfFound is also set, redirect if the user was found\r\n      (redirectIfFound && hasUser)\r\n    ) {\r\n      Router.push(redirectTo);\r\n    }\r\n  }, [redirectTo, redirectIfFound, finished, hasUser]);\r\n  return error ? null : user;\r\n}"]},"metadata":{},"sourceType":"module"}